import{v as ne,r as v,G as ae,k as le,p as ie,x as re,l as m,y as V,c as g,a as e,b as p,d as h,_ as ce,e as C,u as c,F as N,f as P,w as de,T as ue,h as S,t as a,n as A,z as ve,B as ge,o as l,A as F}from"./DX2j-DXT.js";import{S as pe,M as he,a as fe,X as B,F as _e}from"./OwIyKwQK.js";import{u as me}from"./BpEgIk2w.js";import{a as O}from"./xsH4HHeE.js";import{C as ke}from"./CKiWpDDZ.js";import{P as ye,S as L}from"./PwXNhdp3.js";const we={class:"app admin"},be={class:"header-content"},Ce={class:"header-controls"},Se={class:"desktop-nav"},Le=["onClick"],xe={key:0,class:"mobile-nav"},De={class:"mobile-nav-content"},Me=["onClick"],Ne={class:"container"},Pe={key:0,class:"debug-info"},Ae={class:"table-controls"},$e={class:"left-controls"},Ee={key:0,class:"dropdown-menu"},Re={class:"search-box"},Te={class:"table-container"},Ie={class:"data-table"},Ue={key:0},Ve={colspan:"5",style:{"text-align":"center",padding:"20px"}},Fe={class:"action-buttons"},Be=["onClick"],Oe=["onClick"],He={class:"table-footer"},je={class:"entries-info"},ze={class:"pagination"},We=["disabled"],Ge={class:"page-number"},Qe=["disabled"],Xe={__name:"Session",setup(qe){me({title:"Data Sessions",ogTitle:"Data Sessions"});const y=v(!1),w=v(!0),x=v("Artikel"),$=["Home","Logout"],u=ae(),b=v(""),i=v(1),f=v(7),r=v([]),d=v(!1),D=v(null),{API_URL:_}=le().public,H=()=>{w.value=!w.value,document.body.classList.toggle("light-mode",!w.value)},M=()=>{window.innerWidth<=768&&(y.value=!y.value)},j=()=>{d.value=!d.value},E=t=>{D.value&&!D.value.contains(t.target)&&(d.value=!1)},R=async t=>{if(window.innerWidth<=768&&M(),t==="Logout")try{(await(await fetch(`${_}/logout`,{method:"POST",credentials:"include"})).json()).success&&u.push("/rikya")}catch(o){console.error("Logout error:",o)}else t==="Home"?u.push("/rikya/components/Home"):x.value=t},z=async()=>{var t,o,s;try{console.log("Fetching sessions from:",`${_}/sessions-list`);const n=await O.get(`${_}/sessions-list`);console.log("Response status:",n.status),console.log("Response data:",n.data),n.data&&Array.isArray(n.data)?(r.value=n.data.sort((oe,te)=>oe.id-te.id),console.log("Sessions loaded and sorted by ID successfully:",n.data.length,"items")):(console.warn("Response data is not an array:",n.data),r.value=[])}catch(n){console.error("Error fetching sessions:",n),console.error("Error details:",{message:n.message,status:(t=n.response)==null?void 0:t.status,statusText:(o=n.response)==null?void 0:o.statusText,data:(s=n.response)==null?void 0:s.data}),r.value=[]}};ie(async()=>{try{if(console.log("Component mounted, checking session..."),!(await(await fetch(`${_}/check-session`,{credentials:"include"})).json()).isLoggedIn){console.log("User not logged in, redirecting..."),u.push("/rikya");return}console.log("User is logged in, fetching sessions...")}catch(t){console.error("Session check error:",t)}await z(),document.addEventListener("click",E)}),re(()=>{document.removeEventListener("click",E)});const T=m(()=>{if(!r.value||r.value.length===0)return[];const t=b.value.toLowerCase();return t?r.value.filter(s=>s.session_name&&s.session_name.toLowerCase().includes(t)||s.name&&s.name.toLowerCase().includes(t)||s.category_description&&s.category_description.toLowerCase().includes(t)||s.category_name&&s.category_name.toLowerCase().includes(t)||s.category_id&&s.category_id.toString().includes(t)||s.id&&s.id.toString().includes(t)).sort((s,n)=>s.id-n.id):r.value}),k=m(()=>T.value.length),I=m(()=>Math.ceil(k.value/f.value)),U=m(()=>{const t=(i.value-1)*f.value,o=t+f.value;return T.value.slice(t,o)}),W=m(()=>k.value===0?0:(i.value-1)*f.value+1),G=m(()=>{const t=i.value*f.value;return t>k.value?k.value:t}),Q=()=>{d.value=!1,u.push("add_session")},X=()=>{d.value=!1,u.push("LiveStream")},q=()=>{d.value=!1,u.push("Categories")},J=()=>{d.value=!1,u.push("Session")},K=()=>{d.value=!1,u.push("Sosmed")},Y=t=>{u.push(`/rikya/edit_session/${t.id}`)},Z=async t=>{if(confirm("Are you sure you want to delete this session?"))try{await O.delete(`${_}/sessions/${t.id}`),r.value=r.value.filter(s=>s.id!==t.id),alert("Session deleted successfully")}catch(s){console.error("Error deleting session:",s),alert("Failed to delete session")}},ee=()=>{i.value>1&&i.value--},se=()=>{i.value<I.value&&i.value++};return V(b,()=>{i.value=1}),V(f,()=>{i.value=1}),(t,o)=>(l(),g("div",we,[e("header",null,[e("div",be,[o[1]||(o[1]=e("h1",{class:"logo"},[e("img",{src:ce,alt:"RacingStation Logo",class:"logo-image"}),h(" Dashboard ")],-1)),e("div",Ce,[e("button",{onClick:H,class:"icon-button"},[w.value?(l(),C(c(pe),{key:0})):(l(),C(c(he),{key:1}))]),e("button",{onClick:M,class:"icon-button menu-toggle"},[y.value?(l(),C(c(B),{key:1})):(l(),C(c(fe),{key:0}))]),e("nav",Se,[e("ul",null,[(l(),g(N,null,P($,s=>e("li",{key:s},[e("a",{href:"#",onClick:F(n=>R(s),["prevent"]),class:A({active:x.value===s})},a(s),11,Le)])),64))])])])])]),p(ue,{name:"slide"},{default:de(()=>[y.value?(l(),g("nav",xe,[e("div",De,[e("button",{onClick:M,class:"icon-button close-menu"},[p(c(B))]),e("ul",null,[(l(),g(N,null,P($,s=>e("li",{key:s},[e("a",{href:"#",onClick:F(n=>R(s),["prevent"]),class:A({active:x.value===s})},a(s),11,Me)])),64))])])])):S("",!0)]),_:1}),e("div",Ne,[o[10]||(o[10]=e("h2",{class:"black-text"},"Session Management",-1)),r.value.length===0?(l(),g("div",Pe,[e("p",null,"Loading sessions... Total: "+a(r.value.length),1),e("p",null,"API URL: "+a(c(_)),1)])):S("",!0),e("div",Ae,[e("div",$e,[e("div",{class:"dropdown",ref_key:"dropdownRef",ref:D},[e("button",{onClick:j,class:"new-btn dropdown-toggle"},[o[2]||(o[2]=h(" Setup ")),p(c(ke),{class:A(["dropdown-icon",{"rotate-180":d.value}])},null,8,["class"])]),d.value?(l(),g("div",Ee,[e("button",{onClick:Q,class:"dropdown-item"},[p(c(ye),{class:"dropdown-item-icon"}),o[3]||(o[3]=h(" New Session "))]),e("button",{onClick:X,class:"dropdown-item"},[p(c(L),{class:"dropdown-item-icon"}),o[4]||(o[4]=h(" Livestream "))]),e("button",{onClick:q,class:"dropdown-item"},[p(c(L),{class:"dropdown-item-icon"}),o[5]||(o[5]=h(" Categories "))]),e("button",{onClick:J,class:"dropdown-item"},[p(c(L),{class:"dropdown-item-icon"}),o[6]||(o[6]=h(" Session "))]),e("button",{onClick:K,class:"dropdown-item"},[p(c(L),{class:"dropdown-item-icon"}),o[7]||(o[7]=h(" Sosmed "))])])):S("",!0)],512)]),e("div",Re,[o[8]||(o[8]=e("label",null,"Search:",-1)),ve(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=s=>b.value=s),class:"search-input"},null,512),[[ge,b.value]])])]),e("div",Te,[e("table",Ie,[o[9]||(o[9]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"Session Name"),e("th",null,"Category"),e("th",null,"Order"),e("th",null,"Action")])],-1)),e("tbody",null,[U.value.length===0?(l(),g("tr",Ue,[e("td",Ve,a(r.value.length===0?"Loading sessions...":"No sessions found"),1)])):S("",!0),(l(!0),g(N,null,P(U.value,s=>(l(),g("tr",{key:s.id},[e("td",null,a(s.id),1),e("td",null,a(s.session_name||s.name||"N/A"),1),e("td",null,a(s.category_description||"N/A"),1),e("td",null,a(s.session_order||s.order||"N/A"),1),e("td",Fe,[e("button",{onClick:n=>Y(s),class:"edit-btn"},"Edit",8,Be),e("button",{onClick:n=>Z(s),class:"delete-btn"},"Delete",8,Oe)])]))),128))])])]),e("div",He,[e("div",je,"Showing "+a(W.value)+" to "+a(G.value)+" of "+a(k.value)+" entries",1),e("div",ze,[e("button",{onClick:ee,disabled:i.value===1,class:"pagination-btn"},"Previous",8,We),e("span",Ge,a(i.value),1),e("button",{onClick:se,disabled:i.value===I.value,class:"pagination-btn"},"Next",8,Qe)])])]),p(_e)]))}},os=ne(Xe,[["__scopeId","data-v-f310a31d"]]);export{os as default};
