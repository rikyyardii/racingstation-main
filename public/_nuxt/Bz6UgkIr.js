import{v as se,r as d,G as oe,p as I,k as ne,x as ae,l as p,y as le,c as v,a as e,b as u,d as m,_ as ie,e as y,u as a,F as x,f as E,w as re,T as ce,h as O,n as P,z as de,B as ue,t as l,o as i,A as R}from"./DPDbZXkn.js";import{S as ve,M as me,a as pe,X as B,F as he}from"./DwngjW1p.js";import{u as fe}from"./DvjvNq9H.js";import{a as H}from"./xsH4HHeE.js";import{D as ge}from"./DOXiyJsP.js";import{C as _e}from"./C22q4tCv.js";import{P as ke,S as C}from"./CIBCkty8.js";const be={class:"app admin"},we={class:"header-content"},ye={class:"header-controls"},Ce={class:"desktop-nav"},Se=["onClick"],Le={key:0,class:"mobile-nav"},De={class:"mobile-nav-content"},Me=["onClick"],xe={class:"container"},Ee={class:"table-controls"},Pe={class:"left-controls"},Te={key:0,class:"dropdown-menu"},$e={class:"search-box"},Ve={class:"table-container"},Ne={class:"data-table"},Ae={class:"action-buttons"},Fe=["onClick"],Ie=["onClick"],Oe={class:"table-footer"},Re={class:"entries-info"},Be={class:"pagination"},He=["disabled"],Ue={class:"page-number"},je=["disabled"],ze={__name:"LiveStream",setup(We){const g=d(!1),_=d(!0),S=d("Artikel"),T=["Home","Logout"],c=oe(),k=d(""),n=d(1),h=d(5),b=d([]),r=d(!1),L=d(null),U=()=>{_.value=!_.value,document.body.classList.toggle("light-mode",!_.value)},D=()=>{window.innerWidth<=768&&(g.value=!g.value)},j=()=>{r.value=!r.value},$=s=>{L.value&&!L.value.contains(s.target)&&(r.value=!1)},V=async s=>{if(window.innerWidth<=768&&D(),s==="Logout")try{(await(await fetch(`${w}/logout`,{method:"POST",credentials:"include"})).json()).success&&c.push("/rikya")}catch(t){console.error("Logout error:",t)}else s==="Home"?c.push("/rikya/components/Home"):S.value=s};I(async()=>{try{(await(await fetch(`${w}/check-session`,{credentials:"include"})).json()).isLoggedIn||c.push("/rikya")}catch(s){console.error("Session check error:",s)}document.addEventListener("click",$)}),ae(()=>{document.removeEventListener("click",$)});const{API_URL:w}=ne().public;I(async()=>{try{const s=await H.get(`${w}/streams_card`);b.value=s.data}catch(s){console.error("Error fetching streams:",s)}});const N=p(()=>b.value.filter(s=>{const t=k.value.toLowerCase();return Object.values(s).some(o=>o.toString().toLowerCase().includes(t))})),f=p(()=>N.value.length),A=p(()=>Math.ceil(f.value/h.value)),z=p(()=>{const s=(n.value-1)*h.value,t=s+h.value;return N.value.slice(s,t)}),W=p(()=>f.value===0?0:(n.value-1)*h.value+1),Z=p(()=>{const s=n.value*h.value;return s>f.value?f.value:s}),G=()=>{r.value=!1,c.push("add_livestream")},J=()=>{r.value=!1,c.push("LiveStream")},Q=()=>{r.value=!1,c.push("Categories")},X=()=>{r.value=!1,c.push("Session")},q=()=>{r.value=!1,c.push("Sosmed")},K=s=>{c.push(`/rikya/edit_stream/${s}`)},Y=async s=>{if(confirm("Are you sure you want to delete this stream?"))try{await H.delete(`${w}/streams/${s.id}`),b.value=b.value.filter(o=>o.id!==s.id),n.value=1,alert("Stream deleted successfully")}catch(o){console.error("Error deleting stream:",o),alert("Failed to delete stream")}},ee=()=>{n.value>1&&n.value--},te=()=>{n.value<A.value&&n.value++};le(k,()=>{n.value=1});const F=s=>{if(!s)return"-";const t=ge.fromISO(s).setZone("UTC").setZone("Asia/Jakarta");return t.isValid?t.toFormat("dd-MM-yyyy HH:mm"):"Invalid Date"};return fe({title:"Data Streaming",ogTitle:"Data Streaming"}),(s,t)=>(i(),v("div",be,[e("header",null,[e("div",we,[t[1]||(t[1]=e("h1",{class:"logo"},[e("img",{src:ie,alt:"RacingStation Logo",class:"logo-image"}),m(" Dashboard ")],-1)),e("div",ye,[e("button",{onClick:U,class:"icon-button"},[_.value?(i(),y(a(ve),{key:0})):(i(),y(a(me),{key:1}))]),e("button",{onClick:D,class:"icon-button menu-toggle"},[g.value?(i(),y(a(B),{key:1})):(i(),y(a(pe),{key:0}))]),e("nav",Ce,[e("ul",null,[(i(),v(x,null,E(T,o=>e("li",{key:o},[e("a",{href:"#",onClick:R(M=>V(o),["prevent"]),class:P({active:S.value===o})},l(o),11,Se)])),64))])])])])]),u(ce,{name:"slide"},{default:re(()=>[g.value?(i(),v("nav",Le,[e("div",De,[e("button",{onClick:D,class:"icon-button close-menu"},[u(a(B))]),e("ul",null,[(i(),v(x,null,E(T,o=>e("li",{key:o},[e("a",{href:"#",onClick:R(M=>V(o),["prevent"]),class:P({active:S.value===o})},l(o),11,Me)])),64))])])])):O("",!0)]),_:1}),e("div",xe,[t[10]||(t[10]=e("h2",{class:"black-text"},"Livestream Management",-1)),e("div",Ee,[e("div",Pe,[e("div",{class:"dropdown",ref_key:"dropdownRef",ref:L},[e("button",{onClick:j,class:"new-btn dropdown-toggle"},[t[2]||(t[2]=m(" Setup ")),u(a(_e),{class:P(["dropdown-icon",{"rotate-180":r.value}])},null,8,["class"])]),r.value?(i(),v("div",Te,[e("button",{onClick:G,class:"dropdown-item"},[u(a(ke),{class:"dropdown-item-icon"}),t[3]||(t[3]=m(" New Stream "))]),e("button",{onClick:J,class:"dropdown-item"},[u(a(C),{class:"dropdown-item-icon"}),t[4]||(t[4]=m(" Livestream "))]),e("button",{onClick:Q,class:"dropdown-item"},[u(a(C),{class:"dropdown-item-icon"}),t[5]||(t[5]=m(" Categories "))]),e("button",{onClick:X,class:"dropdown-item"},[u(a(C),{class:"dropdown-item-icon"}),t[6]||(t[6]=m(" Session "))]),e("button",{onClick:q,class:"dropdown-item"},[u(a(C),{class:"dropdown-item-icon"}),t[7]||(t[7]=m(" Sosmed "))])])):O("",!0)],512)]),e("div",$e,[t[8]||(t[8]=e("label",null,"Search:",-1)),de(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=o=>k.value=o),class:"search-input"},null,512),[[ue,k.value]])])]),e("div",Ve,[e("table",Ne,[t[9]||(t[9]=e("thead",null,[e("tr",null,[e("th",null,"Title"),e("th",null,"Event"),e("th",null,"Start Live"),e("th",null,"End Live"),e("th",null,"Status"),e("th",null,"Action")])],-1)),e("tbody",null,[(i(!0),v(x,null,E(z.value,o=>(i(),v("tr",{key:o.id},[e("td",null,l(o.title),1),e("td",null,l(o.event),1),e("td",null,l(F(o.scheduled_enable_time)),1),e("td",null,l(F(o.scheduled_disable_time)),1),e("td",null,l(o.status),1),e("td",Ae,[e("button",{onClick:M=>K(o.slug),class:"edit-btn"},"Edit",8,Fe),e("button",{onClick:M=>Y(o),class:"delete-btn"},"Delete",8,Ie)])]))),128))])])]),e("div",Oe,[e("div",Re,"Showing "+l(W.value)+" to "+l(Z.value)+" of "+l(f.value)+" entries",1),e("div",Be,[e("button",{onClick:ee,disabled:n.value===1,class:"pagination-btn"},"Previous",8,He),e("span",Ue,l(n.value),1),e("button",{onClick:te,disabled:n.value===A.value,class:"pagination-btn"},"Next",8,je)])])]),u(he)]))}},Ye=se(ze,[["__scopeId","data-v-72f5079e"]]);export{Ye as default};
