import{v as te,r as u,G as ne,k as ae,p as le,x as ie,l as _,y as V,c as v,a as e,b as p,d as m,_ as re,e as C,u as c,F as M,f as N,w as ce,T as de,h as S,t as a,n as P,z as ue,B as ve,o as l,A as F}from"./Birlwjyq.js";import{S as ge,M as pe,a as he,X as B,F as fe}from"./Cc2j5KgR.js";import{u as _e}from"./CQu4EZGb.js";import{a as O}from"./xsH4HHeE.js";import{C as me}from"./s5jgGApx.js";import{P as ye,S as A}from"./BZj5mIM8.js";const ke={class:"app admin"},we={class:"header-content"},be={class:"header-controls"},Ce={class:"desktop-nav"},Se=["onClick"],Le={key:0,class:"mobile-nav"},xe={class:"mobile-nav-content"},De=["onClick"],Me={class:"container"},Ne={key:0,class:"debug-info"},Pe={class:"table-controls"},Ae={class:"left-controls"},$e={key:0,class:"dropdown-menu"},Ee={class:"search-box"},Re={class:"table-container"},Te={class:"data-table"},Ie={key:0},Ue={colspan:"5",style:{"text-align":"center",padding:"20px"}},Ve={class:"action-buttons"},Fe=["onClick"],Be=["onClick"],Oe={class:"table-footer"},He={class:"entries-info"},je={class:"pagination"},ze=["disabled"],We={class:"page-number"},Ge=["disabled"],Qe={__name:"Session",setup(Xe){_e({title:"Data Sessions",ogTitle:"Data Sessions"});const k=u(!1),w=u(!0),L=u("Artikel"),$=["Home","Logout"],g=ne(),b=u(""),i=u(1),h=u(7),r=u([]),d=u(!1),x=u(null),{API_URL:f}=ae().public,H=()=>{w.value=!w.value,document.body.classList.toggle("light-mode",!w.value)},D=()=>{window.innerWidth<=768&&(k.value=!k.value)},j=()=>{d.value=!d.value},E=o=>{x.value&&!x.value.contains(o.target)&&(d.value=!1)},R=async o=>{if(window.innerWidth<=768&&D(),o==="Logout")try{(await(await fetch(`${f}/logout`,{method:"POST",credentials:"include"})).json()).success&&g.push("/rikya")}catch(t){console.error("Logout error:",t)}else o==="Home"?g.push("/rikya/components/Home"):L.value=o},z=async()=>{var o,t,s;try{console.log("Fetching sessions from:",`${f}/sessions-list`);const n=await O.get(`${f}/sessions-list`);console.log("Response status:",n.status),console.log("Response data:",n.data),n.data&&Array.isArray(n.data)?(r.value=n.data.sort((se,oe)=>se.id-oe.id),console.log("Sessions loaded and sorted by ID successfully:",n.data.length,"items")):(console.warn("Response data is not an array:",n.data),r.value=[])}catch(n){console.error("Error fetching sessions:",n),console.error("Error details:",{message:n.message,status:(o=n.response)==null?void 0:o.status,statusText:(t=n.response)==null?void 0:t.statusText,data:(s=n.response)==null?void 0:s.data}),r.value=[]}};le(async()=>{try{if(console.log("Component mounted, checking session..."),!(await(await fetch(`${f}/check-session`,{credentials:"include"})).json()).isLoggedIn){console.log("User not logged in, redirecting..."),g.push("/rikya");return}console.log("User is logged in, fetching sessions...")}catch(o){console.error("Session check error:",o)}await z(),document.addEventListener("click",E)}),ie(()=>{document.removeEventListener("click",E)});const T=_(()=>{if(!r.value||r.value.length===0)return[];const o=b.value.toLowerCase();return o?r.value.filter(s=>s.session_name&&s.session_name.toLowerCase().includes(o)||s.name&&s.name.toLowerCase().includes(o)||s.category_description&&s.category_description.toLowerCase().includes(o)||s.category_name&&s.category_name.toLowerCase().includes(o)||s.category_id&&s.category_id.toString().includes(o)||s.id&&s.id.toString().includes(o)).sort((s,n)=>s.id-n.id):r.value}),y=_(()=>T.value.length),I=_(()=>Math.ceil(y.value/h.value)),U=_(()=>{const o=(i.value-1)*h.value,t=o+h.value;return T.value.slice(o,t)}),W=_(()=>y.value===0?0:(i.value-1)*h.value+1),G=_(()=>{const o=i.value*h.value;return o>y.value?y.value:o}),Q=()=>{d.value=!1,g.push("add_session")},X=()=>{d.value=!1,g.push("LiveStream")},q=()=>{d.value=!1,g.push("Categories")},J=()=>{d.value=!1,g.push("Session")},K=o=>{g.push(`/rikya/edit_session/${o.id}`)},Y=async o=>{if(confirm("Are you sure you want to delete this session?"))try{await O.delete(`${f}/sessions/${o.id}`),r.value=r.value.filter(s=>s.id!==o.id),alert("Session deleted successfully")}catch(s){console.error("Error deleting session:",s),alert("Failed to delete session")}},Z=()=>{i.value>1&&i.value--},ee=()=>{i.value<I.value&&i.value++};return V(b,()=>{i.value=1}),V(h,()=>{i.value=1}),(o,t)=>(l(),v("div",ke,[e("header",null,[e("div",we,[t[1]||(t[1]=e("h1",{class:"logo"},[e("img",{src:re,alt:"RacingStation Logo",class:"logo-image"}),m(" Dashboard ")],-1)),e("div",be,[e("button",{onClick:H,class:"icon-button"},[w.value?(l(),C(c(ge),{key:0})):(l(),C(c(pe),{key:1}))]),e("button",{onClick:D,class:"icon-button menu-toggle"},[k.value?(l(),C(c(B),{key:1})):(l(),C(c(he),{key:0}))]),e("nav",Ce,[e("ul",null,[(l(),v(M,null,N($,s=>e("li",{key:s},[e("a",{href:"#",onClick:F(n=>R(s),["prevent"]),class:P({active:L.value===s})},a(s),11,Se)])),64))])])])])]),p(de,{name:"slide"},{default:ce(()=>[k.value?(l(),v("nav",Le,[e("div",xe,[e("button",{onClick:D,class:"icon-button close-menu"},[p(c(B))]),e("ul",null,[(l(),v(M,null,N($,s=>e("li",{key:s},[e("a",{href:"#",onClick:F(n=>R(s),["prevent"]),class:P({active:L.value===s})},a(s),11,De)])),64))])])])):S("",!0)]),_:1}),e("div",Me,[t[9]||(t[9]=e("h2",{class:"black-text"},"Session Management",-1)),r.value.length===0?(l(),v("div",Ne,[e("p",null,"Loading sessions... Total: "+a(r.value.length),1),e("p",null,"API URL: "+a(c(f)),1)])):S("",!0),e("div",Pe,[e("div",Ae,[e("div",{class:"dropdown",ref_key:"dropdownRef",ref:x},[e("button",{onClick:j,class:"new-btn dropdown-toggle"},[t[2]||(t[2]=m(" Setup ")),p(c(me),{class:P(["dropdown-icon",{"rotate-180":d.value}])},null,8,["class"])]),d.value?(l(),v("div",$e,[e("button",{onClick:Q,class:"dropdown-item"},[p(c(ye),{class:"dropdown-item-icon"}),t[3]||(t[3]=m(" New Session "))]),e("button",{onClick:X,class:"dropdown-item"},[p(c(A),{class:"dropdown-item-icon"}),t[4]||(t[4]=m(" Livestream "))]),e("button",{onClick:q,class:"dropdown-item"},[p(c(A),{class:"dropdown-item-icon"}),t[5]||(t[5]=m(" Categories "))]),e("button",{onClick:J,class:"dropdown-item"},[p(c(A),{class:"dropdown-item-icon"}),t[6]||(t[6]=m(" Session "))])])):S("",!0)],512)]),e("div",Ee,[t[7]||(t[7]=e("label",null,"Search:",-1)),ue(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>b.value=s),class:"search-input"},null,512),[[ve,b.value]])])]),e("div",Re,[e("table",Te,[t[8]||(t[8]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"Session Name"),e("th",null,"Category"),e("th",null,"Order"),e("th",null,"Action")])],-1)),e("tbody",null,[U.value.length===0?(l(),v("tr",Ie,[e("td",Ue,a(r.value.length===0?"Loading sessions...":"No sessions found"),1)])):S("",!0),(l(!0),v(M,null,N(U.value,s=>(l(),v("tr",{key:s.id},[e("td",null,a(s.id),1),e("td",null,a(s.session_name||s.name||"N/A"),1),e("td",null,a(s.category_description||"N/A"),1),e("td",null,a(s.session_order||s.order||"N/A"),1),e("td",Ve,[e("button",{onClick:n=>K(s),class:"edit-btn"},"Edit",8,Fe),e("button",{onClick:n=>Y(s),class:"delete-btn"},"Delete",8,Be)])]))),128))])])]),e("div",Oe,[e("div",He,"Showing "+a(W.value)+" to "+a(G.value)+" of "+a(y.value)+" entries",1),e("div",je,[e("button",{onClick:Z,disabled:i.value===1,class:"pagination-btn"},"Previous",8,ze),e("span",We,a(i.value),1),e("button",{onClick:ee,disabled:i.value===I.value,class:"pagination-btn"},"Next",8,Ge)])])]),p(fe)]))}},ss=te(Qe,[["__scopeId","data-v-93082fff"]]);export{ss as default};
