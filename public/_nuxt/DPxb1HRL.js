import{s as Z,r as i,G,m as E,k as J,l as r,x as Q,c,a as e,_ as X,b as P,d as b,u as h,F as C,e as S,f as L,w as q,T as K,z as Y,A as ee,t as n,o as l,y as V,n as N,g as te}from"./B683Eh06.js";import{S as se,M as ae,a as oe,X as A,F as ne}from"./D73_bQhw.js";import{u as le}from"./kDA8QHO3.js";import{a as F}from"./CCb-kr4I.js";import{D as ie}from"./DcQSltNB.js";const re={class:"app admin"},ce={class:"header-content"},ue={class:"header-controls"},de={class:"desktop-nav"},ve=["onClick"],he={key:0,class:"mobile-nav"},me={class:"mobile-nav-content"},_e=["onClick"],pe={class:"container"},ge={class:"table-controls"},fe={class:"right-controls"},be={class:"search-box"},ke={class:"table-container"},ye={class:"data-table"},we={class:"action-buttons"},Ce=["onClick"],Se=["onClick"],Le={class:"table-footer"},Me={class:"entries-info"},xe={class:"pagination"},De=["disabled"],Te={class:"page-number"},$e=["disabled"],Ee={__name:"LiveStream",setup(Pe){const m=i(!1),_=i(!0),k=i("Artikel"),M=["Home","Logout"],u=G(),p=i(""),o=i(1),d=i(5),g=i([]),I=()=>{_.value=!_.value,document.body.classList.toggle("light-mode",!_.value)},y=()=>{window.innerWidth<=768&&(m.value=!m.value)},x=async t=>{if(window.innerWidth<=768&&y(),t==="Logout")try{(await(await fetch(`${f}/logout`,{method:"POST",credentials:"include"})).json()).success&&u.push("/rikya")}catch(a){console.error("Logout error:",a)}else t==="Home"?u.push("/rikya/components/Home"):k.value=t};E(async()=>{try{(await(await fetch(`${f}/check-session`,{credentials:"include"})).json()).isLoggedIn||u.push("/rikya")}catch(t){console.error("Session check error:",t)}});const{API_URL:f}=J().public;E(async()=>{try{const t=await F.get(`${f}/streams_card`);g.value=t.data}catch(t){console.error("Error fetching streams:",t)}});const D=r(()=>g.value.filter(t=>{const a=p.value.toLowerCase();return Object.values(t).some(s=>s.toString().toLowerCase().includes(a))})),v=r(()=>D.value.length),T=r(()=>Math.ceil(v.value/d.value)),H=r(()=>{const t=(o.value-1)*d.value,a=t+d.value;return D.value.slice(t,a)}),B=r(()=>v.value===0?0:(o.value-1)*d.value+1),O=r(()=>{const t=o.value*d.value;return t>v.value?v.value:t}),R=()=>{u.push("add_livestream")},j=t=>{u.push(`/rikya/edit_stream/${t}`)},U=async t=>{if(confirm("Are you sure you want to delete this stream?"))try{await F.delete(`${f}/streams/${t.id}`),g.value=g.value.filter(s=>s.id!==t.id),o.value=1,alert("Stream deleted successfully")}catch(s){console.error("Error deleting stream:",s),alert("Failed to delete stream")}},z=()=>{o.value>1&&o.value--},W=()=>{o.value<T.value&&o.value++};Q(p,()=>{o.value=1});const $=t=>{if(!t)return"-";const a=ie.fromISO(t).setZone("UTC").setZone("Asia/Jakarta");return a.isValid?a.toFormat("dd-MM-yyyy HH:mm"):"Invalid Date"};return le({title:"Data Streaming",ogTitle:"Data Streaming"}),(t,a)=>(l(),c("div",re,[e("header",null,[e("div",ce,[a[1]||(a[1]=e("h1",{class:"logo"},[e("img",{src:X,alt:"RacingStation Logo",class:"logo-image"}),P(" Dashboard ")],-1)),e("div",ue,[e("button",{onClick:I,class:"icon-button"},[_.value?(l(),b(h(se),{key:0})):(l(),b(h(ae),{key:1}))]),e("button",{onClick:y,class:"icon-button menu-toggle"},[m.value?(l(),b(h(A),{key:1})):(l(),b(h(oe),{key:0}))]),e("nav",de,[e("ul",null,[(l(),c(C,null,S(M,s=>e("li",{key:s},[e("a",{href:"#",onClick:V(w=>x(s),["prevent"]),class:N({active:k.value===s})},n(s),11,ve)])),64))])])])])]),L(K,{name:"slide"},{default:q(()=>[m.value?(l(),c("nav",he,[e("div",me,[e("button",{onClick:y,class:"icon-button close-menu"},[L(h(A))]),e("ul",null,[(l(),c(C,null,S(M,s=>e("li",{key:s},[e("a",{href:"#",onClick:V(w=>x(s),["prevent"]),class:N({active:k.value===s})},n(s),11,_e)])),64))])])])):te("",!0)]),_:1}),e("div",pe,[a[5]||(a[5]=e("h2",{class:"black-text"},"Livestream Management",-1)),e("div",ge,[e("div",{class:"left-controls"},[e("button",{onClick:R,class:"new-btn"},a[2]||(a[2]=[e("span",{class:"plus-icon"},"+",-1),P(" New")]))]),e("div",fe,[e("div",be,[a[3]||(a[3]=e("label",null,"Search:",-1)),Y(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=s=>p.value=s),class:"search-input"},null,512),[[ee,p.value]])])])]),e("div",ke,[e("table",ye,[a[4]||(a[4]=e("thead",null,[e("tr",null,[e("th",null,"Title"),e("th",null,"Event"),e("th",null,"Start Live"),e("th",null,"End Live"),e("th",null,"Status"),e("th",null,"Action")])],-1)),e("tbody",null,[(l(!0),c(C,null,S(H.value,s=>(l(),c("tr",{key:s.id},[e("td",null,n(s.title),1),e("td",null,n(s.event),1),e("td",null,n($(s.scheduled_enable_time)),1),e("td",null,n($(s.scheduled_disable_time)),1),e("td",null,n(s.status),1),e("td",we,[e("button",{onClick:w=>j(s.slug),class:"edit-btn"},"Edit",8,Ce),e("button",{onClick:w=>U(s),class:"delete-btn"},"Delete",8,Se)])]))),128))])])]),e("div",Le,[e("div",Me,"Showing "+n(B.value)+" to "+n(O.value)+" of "+n(v.value)+" entries",1),e("div",xe,[e("button",{onClick:z,disabled:o.value===1,class:"pagination-btn"},"Previous",8,De),e("span",Te,n(o.value),1),e("button",{onClick:W,disabled:o.value===T.value,class:"pagination-btn"},"Next",8,$e)])])]),L(ne)]))}},He=Z(Ee,[["__scopeId","data-v-1b505b6c"]]);export{He as default};
