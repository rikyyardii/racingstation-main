import{v as te,r as c,G as se,p as I,k as oe,x as ne,l as m,y as ae,c as v,a as e,b as d,d as p,_ as le,e as y,u as i,F as M,f as x,w as ie,T as re,h as O,n as E,z as ce,B as ue,t as a,o as l,A as R}from"./Birlwjyq.js";import{S as de,M as ve,a as me,X as B,F as pe}from"./Cc2j5KgR.js";import{u as he}from"./CQu4EZGb.js";import{a as H}from"./xsH4HHeE.js";import{D as fe}from"./DOXiyJsP.js";import{C as _e}from"./s5jgGApx.js";import{P as ge,S as P}from"./BZj5mIM8.js";const ke={class:"app admin"},be={class:"header-content"},we={class:"header-controls"},ye={class:"desktop-nav"},Ce=["onClick"],Se={key:0,class:"mobile-nav"},Le={class:"mobile-nav-content"},De=["onClick"],Me={class:"container"},xe={class:"table-controls"},Ee={class:"left-controls"},Pe={key:0,class:"dropdown-menu"},Te={class:"search-box"},$e={class:"table-container"},Ve={class:"data-table"},Ne={class:"action-buttons"},Ae=["onClick"],Fe=["onClick"],Ie={class:"table-footer"},Oe={class:"entries-info"},Re={class:"pagination"},Be=["disabled"],He={class:"page-number"},Ue=["disabled"],je={__name:"LiveStream",setup(ze){const _=c(!1),g=c(!0),C=c("Artikel"),T=["Home","Logout"],u=se(),k=c(""),n=c(1),h=c(5),b=c([]),r=c(!1),S=c(null),U=()=>{g.value=!g.value,document.body.classList.toggle("light-mode",!g.value)},L=()=>{window.innerWidth<=768&&(_.value=!_.value)},j=()=>{r.value=!r.value},$=s=>{S.value&&!S.value.contains(s.target)&&(r.value=!1)},V=async s=>{if(window.innerWidth<=768&&L(),s==="Logout")try{(await(await fetch(`${w}/logout`,{method:"POST",credentials:"include"})).json()).success&&u.push("/rikya")}catch(t){console.error("Logout error:",t)}else s==="Home"?u.push("/rikya/components/Home"):C.value=s};I(async()=>{try{(await(await fetch(`${w}/check-session`,{credentials:"include"})).json()).isLoggedIn||u.push("/rikya")}catch(s){console.error("Session check error:",s)}document.addEventListener("click",$)}),ne(()=>{document.removeEventListener("click",$)});const{API_URL:w}=oe().public;I(async()=>{try{const s=await H.get(`${w}/streams_card`);b.value=s.data}catch(s){console.error("Error fetching streams:",s)}});const N=m(()=>b.value.filter(s=>{const t=k.value.toLowerCase();return Object.values(s).some(o=>o.toString().toLowerCase().includes(t))})),f=m(()=>N.value.length),A=m(()=>Math.ceil(f.value/h.value)),z=m(()=>{const s=(n.value-1)*h.value,t=s+h.value;return N.value.slice(s,t)}),W=m(()=>f.value===0?0:(n.value-1)*h.value+1),Z=m(()=>{const s=n.value*h.value;return s>f.value?f.value:s}),G=()=>{r.value=!1,u.push("add_livestream")},J=()=>{r.value=!1,u.push("LiveStream")},Q=()=>{r.value=!1,u.push("Categories")},X=()=>{r.value=!1,u.push("Session")},q=s=>{u.push(`/rikya/edit_stream/${s}`)},K=async s=>{if(confirm("Are you sure you want to delete this stream?"))try{await H.delete(`${w}/streams/${s.id}`),b.value=b.value.filter(o=>o.id!==s.id),n.value=1,alert("Stream deleted successfully")}catch(o){console.error("Error deleting stream:",o),alert("Failed to delete stream")}},Y=()=>{n.value>1&&n.value--},ee=()=>{n.value<A.value&&n.value++};ae(k,()=>{n.value=1});const F=s=>{if(!s)return"-";const t=fe.fromISO(s).setZone("UTC").setZone("Asia/Jakarta");return t.isValid?t.toFormat("dd-MM-yyyy HH:mm"):"Invalid Date"};return he({title:"Data Streaming",ogTitle:"Data Streaming"}),(s,t)=>(l(),v("div",ke,[e("header",null,[e("div",be,[t[1]||(t[1]=e("h1",{class:"logo"},[e("img",{src:le,alt:"RacingStation Logo",class:"logo-image"}),p(" Dashboard ")],-1)),e("div",we,[e("button",{onClick:U,class:"icon-button"},[g.value?(l(),y(i(de),{key:0})):(l(),y(i(ve),{key:1}))]),e("button",{onClick:L,class:"icon-button menu-toggle"},[_.value?(l(),y(i(B),{key:1})):(l(),y(i(me),{key:0}))]),e("nav",ye,[e("ul",null,[(l(),v(M,null,x(T,o=>e("li",{key:o},[e("a",{href:"#",onClick:R(D=>V(o),["prevent"]),class:E({active:C.value===o})},a(o),11,Ce)])),64))])])])])]),d(re,{name:"slide"},{default:ie(()=>[_.value?(l(),v("nav",Se,[e("div",Le,[e("button",{onClick:L,class:"icon-button close-menu"},[d(i(B))]),e("ul",null,[(l(),v(M,null,x(T,o=>e("li",{key:o},[e("a",{href:"#",onClick:R(D=>V(o),["prevent"]),class:E({active:C.value===o})},a(o),11,De)])),64))])])])):O("",!0)]),_:1}),e("div",Me,[t[9]||(t[9]=e("h2",{class:"black-text"},"Livestream Management",-1)),e("div",xe,[e("div",Ee,[e("div",{class:"dropdown",ref_key:"dropdownRef",ref:S},[e("button",{onClick:j,class:"new-btn dropdown-toggle"},[t[2]||(t[2]=p(" Setup ")),d(i(_e),{class:E(["dropdown-icon",{"rotate-180":r.value}])},null,8,["class"])]),r.value?(l(),v("div",Pe,[e("button",{onClick:G,class:"dropdown-item"},[d(i(ge),{class:"dropdown-item-icon"}),t[3]||(t[3]=p(" New Stream "))]),e("button",{onClick:J,class:"dropdown-item"},[d(i(P),{class:"dropdown-item-icon"}),t[4]||(t[4]=p(" Livestream "))]),e("button",{onClick:Q,class:"dropdown-item"},[d(i(P),{class:"dropdown-item-icon"}),t[5]||(t[5]=p(" Categories "))]),e("button",{onClick:X,class:"dropdown-item"},[d(i(P),{class:"dropdown-item-icon"}),t[6]||(t[6]=p(" Session "))])])):O("",!0)],512)]),e("div",Te,[t[7]||(t[7]=e("label",null,"Search:",-1)),ce(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=o=>k.value=o),class:"search-input"},null,512),[[ue,k.value]])])]),e("div",$e,[e("table",Ve,[t[8]||(t[8]=e("thead",null,[e("tr",null,[e("th",null,"Title"),e("th",null,"Event"),e("th",null,"Start Live"),e("th",null,"End Live"),e("th",null,"Status"),e("th",null,"Action")])],-1)),e("tbody",null,[(l(!0),v(M,null,x(z.value,o=>(l(),v("tr",{key:o.id},[e("td",null,a(o.title),1),e("td",null,a(o.event),1),e("td",null,a(F(o.scheduled_enable_time)),1),e("td",null,a(F(o.scheduled_disable_time)),1),e("td",null,a(o.status),1),e("td",Ne,[e("button",{onClick:D=>q(o.slug),class:"edit-btn"},"Edit",8,Ae),e("button",{onClick:D=>K(o),class:"delete-btn"},"Delete",8,Fe)])]))),128))])])]),e("div",Ie,[e("div",Oe,"Showing "+a(W.value)+" to "+a(Z.value)+" of "+a(f.value)+" entries",1),e("div",Re,[e("button",{onClick:Y,disabled:n.value===1,class:"pagination-btn"},"Previous",8,Be),e("span",He,a(n.value),1),e("button",{onClick:ee,disabled:n.value===A.value,class:"pagination-btn"},"Next",8,Ue)])])]),d(pe)]))}},Ke=te(je,[["__scopeId","data-v-cc2d2e2c"]]);export{Ke as default};
